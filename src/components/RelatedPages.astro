---
import type { RelatedPage } from '../lib/types';

interface Props {
  pages: RelatedPage[];
  currentEvent: string;
  currentGuests: number;
}

const { pages, currentEvent, currentGuests } = Astro.props;

// Group by relationship type
const sameEvent = pages.filter(p => p.relationship === 'same-event');
const adjacentGuests = pages.filter(p => p.relationship === 'adjacent-guests');
const sameItem = pages.filter(p => p.relationship === 'same-item');
---

<section class="py-16 bg-gradient-to-b from-white to-slate-50">
  <div class="max-w-5xl mx-auto px-4">
    <div class="text-center mb-10">
      <h2 class="font-display text-2xl md:text-3xl font-bold text-slate-900 mb-3">
        Explore More Calculators
      </h2>
      <p class="text-slate-500">Find the perfect amounts for any event</p>
    </div>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Same Event, Different Items -->
      {sameEvent.length > 0 && (
        <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-100 hover:shadow-xl transition-all group">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl flex items-center justify-center text-white text-lg">
              <span>+</span>
            </div>
            <h3 class="font-semibold text-slate-900 text-sm uppercase tracking-wide">
              More for your {currentEvent}
            </h3>
          </div>
          <ul class="space-y-3">
            {sameEvent.map((page) => (
              <li>
                <a
                  href={`/${page.slug}`}
                  class="flex items-center gap-2 text-slate-700 hover:text-emerald-600 transition-colors text-sm group/link"
                >
                  <span class="w-1.5 h-1.5 bg-amber-400 rounded-full group-hover/link:bg-emerald-500 transition-colors"></span>
                  {page.title}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}

      <!-- Different Guest Counts -->
      {adjacentGuests.length > 0 && (
        <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-100 hover:shadow-xl transition-all group">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-xl flex items-center justify-center text-white text-lg">
              <span>#</span>
            </div>
            <h3 class="font-semibold text-slate-900 text-sm uppercase tracking-wide">
              Different guest count?
            </h3>
          </div>
          <ul class="space-y-3">
            {adjacentGuests.map((page) => (
              <li>
                <a
                  href={`/${page.slug}`}
                  class="flex items-center gap-2 text-slate-700 hover:text-emerald-600 transition-colors text-sm group/link"
                >
                  <span class="w-1.5 h-1.5 bg-emerald-400 rounded-full group-hover/link:bg-emerald-600 transition-colors"></span>
                  {page.title}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}

      <!-- Same Item, Different Events -->
      {sameItem.length > 0 && (
        <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-100 hover:shadow-xl transition-all group">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 bg-gradient-to-br from-orange-400 to-amber-500 rounded-xl flex items-center justify-center text-white text-lg">
              <span>*</span>
            </div>
            <h3 class="font-semibold text-slate-900 text-sm uppercase tracking-wide">
              Other events ({currentGuests} guests)
            </h3>
          </div>
          <ul class="space-y-3">
            {sameItem.map((page) => (
              <li>
                <a
                  href={`/${page.slug}`}
                  class="flex items-center gap-2 text-slate-700 hover:text-emerald-600 transition-colors text-sm group/link"
                >
                  <span class="w-1.5 h-1.5 bg-orange-400 rounded-full group-hover/link:bg-emerald-500 transition-colors"></span>
                  {page.title}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  </div>
</section>
